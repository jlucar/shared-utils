import e from"lodash";const{each:t,setWith:s}=e,o=e=>{const o={};return t(e,(e,t)=>{s(o,t,e,Object)}),o},{has:l}=e,n=e=>{const t={};return function e(t,s,o=[]){Object.entries(s).forEach(([s,n])=>{"object"!=typeof n||Array.isArray(n)||l(n,"default")?t[[...o,s].join(".")]=n:e(t,n,[...o,s])})}(t,e),t};function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},a.apply(this,arguments)}const{each:r,isBoolean:i,isObject:c,last:u,split:f,startsWith:d,trimEnd:p}=e,b=e=>{const t={},s=((e,t="")=>{const s=function e(t,s){if(!t||"object"!=typeof t)return[{[s]:t}];const o=s?Array.isArray(t)?s:`${s}.`:"";return Object.keys(t).flatMap(s=>e(t[s],Array.isArray(t)?`${o}[${s}]`:`${o}${s}`)).reduce((e,t)=>a({},e,t),[])}(e,t),o={};return r(s,(e,t)=>{const s=f(t,"."),l=u(s);d(l,"#")?"#value"===l&&(o[p(t,".#value")]=e):o[t]=e}),o})(e);return r(s,(e,s)=>{let o=e;c(e)&&(o=e["#value"]);const l={default:o};i(o)&&(l.type="switch"),t[s]=l}),t},{map:y}=e,g=(e,t)=>{const s=n(t);return y(s,t=>("object"==typeof t&&(t.group=e),t)),s},{assign:m,has:h,isBoolean:$,isObject:v,map:j,mapValues:w,merge:C,size:I}=e,k=(e,t,s=null)=>{let o=null;const l="object"==typeof s&&I(s)||-1;if(1!==l)throw new Error(`The "${e}" group must only have one parent key, ${l} given.`);const n="object"==typeof s&&w(s,(e,s)=>{if(!o){let l={type:"switch",default:t};if(v(t)){if(!h(t,"default")||!$(t.default))throw new Error('A "default" boolean value must be supplied in the object');C(l,t)}e=m({enabled:l},e),o=`${s}.enabled`}return e});let a=g(e,n);return j(a,(e,t)=>("object"==typeof e&&t!==o&&(e.visibleIf=o),e)),a},{has:O,map:A,mapKeys:V}=e,E=(t,s=null)=>{let o={};const l=`${t}.isVisible`;o.isVisible={type:"switch",label:"Visible",default:!0,group:t,styleClasses:"col-md-2"},o.required={type:"switch",label:"Required",default:!1,group:t,visibleIf:l,styleClasses:"col-md-2"},o.disabled={type:"switch",label:"Disabled",default:!1,group:t,visibleIf:l,styleClasses:"col-md-2"},o.readonly={type:"switch",label:"Readonly",default:!1,group:t,visibleIf:l,styleClasses:"col-md-2"},o.hasAutoFocus={type:"switch",label:"Autofocus",default:!1,group:t,visibleIf:l,styleClasses:"col-md-2"},o.pattern={type:"input",label:"Pattern",default:"",group:t,visibleIf:l,styleClasses:"col-md-12"},s&&(o=s(o),A(o,(s,o)=>{"object"!=typeof s||O(s,"group")||(s.group=t),"object"!=typeof s||"isVisible"===o||O(s,"visibleIf")||e.set(s,"visibleIf",l),"object"!=typeof s||O(s,"styleClasses")||(s.styleClasses="col-md-12")}));const n=V(o,(e,s)=>`${t}.${s}`);return g(t,n)},{merge:F}=e,q=(e,t=null,s=null,o=null)=>{const l={configs:{}};return e&&(l.configs=e),t&&(l.category=t),s&&(l.section=s),o&&F(l,o),l},{mapValues:D,merge:L}=e,R=(e,t)=>D(e,e=>(L(e,{subsection:t}),e)),{assign:x,has:K,map:N,mapValues:P,setWith:T}=e,W=(t,s)=>t.map(t=>{const o="string"==typeof t?t:e.get(t,"key");if(K(s,o)){const e="object"==typeof t?t:{};return delete e.key,x({model:o},s[o],e)}return console.log(`${o} is not a config!`),null}).filter(e=>{if(null!==e)return e}),z=(e,t,s)=>{const o={name:e,schema:[],model:{}};if(t){const e=((e,t)=>P(e,(e,s)=>({id:s,order:Number(s),label:e.label,fields:W(e.fields,t)})))(t,s);o.schema=e,o.model=(e=>{const t={};return N(e,e=>{N(e.fields,e=>{T(t,e.model,e.default,Object)})}),t})(e)}return o},{assign:B,each:S,get:G,has:M,isObject:U,kebabCase:H,last:J,mapKeys:Q,mapValues:X,merge:Y,set:Z,size:_,split:ee,startCase:te,unset:se}=e,oe=e=>"object"==typeof e&&"boolean"==typeof e.default?"switch":"input",le=(e,t,s=!1)=>{if(U(t)){if(!s&&!M(t,"default"))throw new Error(`Config "${e}" is missing a "default" value.`)}else t={default:t};return t},ne=(e,t,s={})=>{if(delete(t=le(e,t)).key,t.docLink){const e=`Documentation on this feature can be found <a href="${t.docLink}">here</a>.`;t.hint=t.hint?e+`<br>${t.hint}`:e,delete t.docLink}return B({default:null,type:oe(t),label:te(J(ee(e,"."))),category:"setting"},t,s)},ae=(t,s={},o)=>(t=Q(t,(t,s)=>e.get(t,"key",s)),X(t,(e,t)=>(o&&o(t,e),ne(t,e,s)))),re=(e,t,s)=>{Y(e,((e,t,s)=>ae(t,s,t=>{if(M(e,t))throw new Error(`Duplicate key: "${t}"`)}))(e,t,s))},ie=(e,t)=>B({label:te(J(ee(e,"."))),order:0,toggleable:!1,description:null,rootKey:null},t),ce=async({getComponents:t,getConfigs:s,getLabel:o,getName:l,source:n})=>{const a=l?await l():n,r={name:a,label:o?await o():te(a)},i=t?await t():null;if(s){const e=ae(await s()),t=((e,t={})=>{const s={};let o=!1;return S(e,e=>{if("object"==typeof e&&M(e,"component")){if(!M(s,e.component)){let o={};if(M(t,e.component)){const{getOptions:s}=t[e.component];o=s?s():t[e.component]}s[e.component]=ie(e.component,o)}}else o=!0}),o&&_(s)&&(s.unsorted=ie("unsorted",{order:999})),s})(e,i);Y(r,{config:e,components:t})}else{const{components:t,configs:s}=(t=>{const s={},o=(e=>X(e,(e,t)=>{const{getOptions:s}=e;return ie(t,s?s():null)}))(t);return S(t,(t,l)=>{const{getConfigs:n,getSettings:a,getTranslations:r,getUI:i}=t,c={component:l},u=((t,s)=>{const o={group:{path:"groups"},tab:{path:"tabs"}},l=(e,t=null)=>{const s={};return S(e,(e,o)=>{if(e=le(o,e),t){const{config:l,key:n}=t(o,e);s[n]=l}else s[o]=e}),s},n=(e,n,a,r=!0,i="group",c)=>(((e,l,n,a="group")=>{let r=o[a].path,i={};S(n,e=>{if("object"==typeof e&&e.group){const l=e.group;S(o,e=>{const o=G(t,[s,e.path,l]);if(o){Z(i,[e.path,l],o),se(t,[s,e.path,l]);const n=G(t,[s,e.path],{});0===_(n)&&se(t,[s,e.path])}})}}),Z(t,[s,r,e],B({label:l},i))})(e,n,a,i),l(a,(t,s)=>(s.group=s.group?`${e}.${s.group}`:e,c&&c(t,s),{key:r?`${e}.${t}`:t,config:s})));return{addNested:(e,t)=>l(t,(t,s)=>("object"==typeof s&&s.visibleIf&&(s.visibleIf=`${e}.${s.visibleIf}`),{key:`${e}.${t}`,config:s})),addFeature:(t,s,o,l=!1,a=!0)=>{if(M(o,"enabled"))throw new Error(`Feature "${t}" should not contain a property named "enabled".`);return o=B({enabled:le("enabled",l)},o),n(t,s,o,a,"group",(s,o)=>{"enabled"!==s&&"object"==typeof o&&e.set(o,"visibleIf",`${t}.enabled`)})},addGroup:n,addTab:(e,t)=>{const s=H(e);return n(s,e,t,!1,"tab")},addField:(e,t)=>{let s={};const o=`${e}.isVisible`;if(s.isVisible={default:!0,label:"Visible",styleClasses:"col-md-2"},s.required={default:!1,label:"Required",visibleIf:o,styleClasses:"col-md-2"},s.disabled={default:!1,label:"Disabled",visibleIf:o,styleClasses:"col-md-2"},s.readonly={default:!1,label:"Readonly",visibleIf:o,styleClasses:"col-md-2"},s.hasAutoFocus={default:!1,label:"Autofocus",visibleIf:o,styleClasses:"col-md-2"},s.pattern={default:"",label:"Pattern",visibleIf:o,styleClasses:"col-md-12"},t){const e=(e,t)=>{if(M(s,e))throw new Error(`Field ${e} already exists!`);s[e]=ne(e,t,{visibleIf:o,styleClasses:"col-md-12"})},l=(e,t)=>{Y(s[e],le(e,t,!0))};t&&t({insert:e,modify:l})}return n(e,te(e),s,!0)}}})(o,l);n?re(s,n(u),c):(a&&re(s,a(u),B(c,{category:"setting"})),r&&re(s,r(u),B(c,{category:"translation"})),i&&re(s,i(u),B(c,{category:"ui"})))}),{configs:s,components:o}})(i);Y(r,{configs:s,components:t})}return r},ue=(e,t=null)=>{t=B({nested:!1},t);const s={};return S(e,(e,t)=>{s[t]=e.default}),t.nested?o(s):s};class fe extends Error{constructor(e,t){super(`${t.message} ("${e}" source)`),this.name="SourceError"}}export{fe as SourceError,o as convertToNested,n as createConfigs,b as createConfigsFromJson,k as createFeature,E as createField,g as createGroup,q as createSection,R as createSubSection,ue as getMockResponse,z as parseOnboarder,ce as parseSource};
//# sourceMappingURL=index.modern.js.map
