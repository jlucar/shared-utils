import e from"lodash";var t;!function(e){e.Settings="settings",e.Translations="translations",e.UI="ui"}(t||(t={}));const l={setting:{plural:t.Settings,label:"Setting",labelPlural:"Settings",order:1},translation:{plural:t.Translations,label:"Translation",labelPlural:"Translations",order:2},ui:{plural:t.UI,label:"UI",labelPlural:"UI",order:3},ORGANIZATION_SETTINGS:{plural:"ORGANIZATION_SETTINGS",label:"Organization",labelPlural:"Organization",order:1},TRANSLATION_SETTINGS:{plural:"TRANSLATION_SETTINGS",label:"Translation",labelPlural:"Translations",order:2},FEATURE_SETTINGS:{plural:"FEATURE_SETTINGS",label:"Feature",labelPlural:"Features",order:3}},{assign:a,mapValues:n}=e,o=(e={})=>(e=n(e,()=>!0),a({nested:!1,categorized:!1},e)),{each:s,setWith:r}=e,i=e=>{const t={};return s(e,(e,l)=>{r(t,l,e,Object)}),t},{each:u,get:c}=e,b=(e,t={},l=null)=>{const a=o(t),n=((e,t=null)=>{const l={};return u(e,(e,a)=>{if(t){const{key:l,value:n}=t(a,e);l&&(a=l),n&&(e=n)}l[a]=e}),l})(e,e=>{if(a.categorized){const t=c(l,e);t&&(e=`${t.category}.${e}`)}return{key:e}});return a.nested?i(n):n},{each:d,has:g}=e,f=(e,t={})=>{const a=o(t),n=((e,t=null)=>{const l={};return d(e,(e,a)=>{let n=g(e,"value")?e.value:e.default;if(t){const{key:l,value:o}=t(a,e);l&&(a=l),o&&(n=o)}l[a]=n}),l})(e,(e,t)=>({key:e=a.categorized?`${l[t.category].plural}.${e}`:e}));return a.nested?i(n):n},{assign:p,each:y,get:m,has:h,isObject:$,kebabCase:T,last:I,mapKeys:S,mapValues:v,merge:E,set:L,size:N,split:w,startCase:O,unset:k}=e,A=e=>"object"==typeof e&&"boolean"==typeof e.default?"switch":"input",C=(e,t,l=!1)=>{if($(t)){if(!l&&!h(t,"default"))throw new Error(`Config "${e}" is missing a "default" value.`)}else t={default:t};return t},R=(e,t,l={})=>{if(delete(t=C(e,t)).key,t.docLink){const e=`Documentation on this feature can be found <a href="${t.docLink}">here</a>.`;t.hint=t.hint?e+`<br>${t.hint}`:e,delete t.docLink}return p({default:null,type:A(t),label:O(I(w(e,"."))),category:"setting"},t,l)},j=(t,l={},a)=>(t=S(t,(t,l)=>e.get(t,"key",l)),v(t,(e,t)=>(a&&a(t,e),R(t,e,l)))),F=(e,t,l)=>{E(e,((e,t,l)=>j(t,l,t=>{if(h(e,t))throw new Error(`Duplicate key: "${t}"`)}))(e,t,l))},G=(e,t)=>p({label:O(I(w(e,"."))),order:0,toggleable:!1,description:null,rootKey:null},t),P=async({getComponents:t,getConfigs:l,getLabel:a,getName:n,source:o})=>{const s=n?await n():o,r={name:s,label:a?await a():O(s)},i=t?await t():null;if(l){const e=j(await l()),t=((e,t={})=>{const l={};let a=!1;return y(e,e=>{if("object"==typeof e&&h(e,"component")){if(!h(l,e.component)){let a={};if(h(t,e.component)){const{getOptions:l}=t[e.component];a=l?l():t[e.component]}l[e.component]=G(e.component,a)}}else a=!0}),a&&N(l)&&(l.unsorted=G("unsorted",{order:999})),l})(e,i);E(r,{config:e,components:t})}else{const{components:t,configs:l}=(t=>{const l={},a=(e=>v(e,(e,t)=>{const{getOptions:l}=e;return G(t,l?l():null)}))(t);return y(t,(t,n)=>{const{getConfigs:o,getSettings:s,getTranslations:r,getUI:i}=t,u={component:n},c=((t,l)=>{const a={group:{path:"groups"},tab:{path:"tabs"}},n=(e,t=null)=>{const l={};return y(e,(e,a)=>{if(e=C(a,e),t){const{config:n,key:o}=t(a,e);l[o]=n}else l[a]=e}),l},o=(e,o,s,r=!0,i="group",u)=>(((e,n,o,s="group")=>{let r=a[s].path,i={};y(o,e=>{if("object"==typeof e&&e.group){const n=e.group;y(a,e=>{const a=m(t,[l,e.path,n]);if(a){L(i,[e.path,n],a),k(t,[l,e.path,n]);const o=m(t,[l,e.path],{});0===N(o)&&k(t,[l,e.path])}})}}),L(t,[l,r,e],p({label:n},i))})(e,o,s,i),n(s,(t,l)=>(l.group=l.group?`${e}.${l.group}`:e,u&&u(t,l),{key:r?`${e}.${t}`:t,config:l})));return{addNested:(e,t)=>n(t,(t,l)=>("object"==typeof l&&(l.visibleIf&&(l.visibleIf=`${e}.${l.visibleIf}`),l.longLabel=`${O(e)} ⇢ ${l.longLabel?l.longLabel:l.label?l.label:O(t)}`),{key:`${e}.${t}`,config:l})),addFeature:(t,l,a,n=!1,s=!0)=>{if(h(a,"enabled"))throw new Error(`Feature "${t}" should not contain a property named "enabled".`);return a=p({enabled:C("enabled",n)},a),o(t,l,a,s,"group",(l,a)=>{"enabled"!==l&&"object"==typeof a&&e.set(a,"visibleIf",`${t}.enabled`)})},addGroup:o,addTab:(e,t)=>{const l=T(e);return o(l,e,t,!1,"tab")},addField:(e,t)=>{let l={};const a=`${e}.isVisible`,n=O(e);if(l.isVisible={default:!0,label:"Visible",longLabel:`${n} ⇢ Visible`,styleClasses:"col-md-2"},l.required={default:!1,label:"Required",longLabel:`${n} ⇢ Required`,visibleIf:a,styleClasses:"col-md-2"},l.disabled={default:!1,label:"Disabled",longLabel:`${n} ⇢ Disabled`,visibleIf:a,styleClasses:"col-md-2"},l.readonly={default:!1,label:"Readonly",longLabel:`${n} ⇢ Readonly`,visibleIf:a,styleClasses:"col-md-2"},l.hasAutoFocus={default:!1,label:"Autofocus",longLabel:`${n} ⇢ Autofocus`,visibleIf:a,styleClasses:"col-md-2"},l.pattern={default:"",label:"Pattern",longLabel:`${n} ⇢ Pattern`,visibleIf:a,styleClasses:"col-md-12"},t){const e=(e,t)=>{if(h(l,e))throw new Error(`Field ${e} already exists!`);const o=R(e,t,{visibleIf:a,styleClasses:"col-md-12"});o.longLabel=`${n} ⇢ ${o.label}`,l[e]=o},o=(e,t)=>{E(l[e],C(e,t,!0))};t&&t({insert:e,modify:o})}return o(e,O(e),l,!0)}}})(a,n);o?F(l,o(c),u):(s&&F(l,s(c),p(u,{category:"setting"})),r&&F(l,r(c),p(u,{category:"translation"})),i&&F(l,i(c),p(u,{category:"ui"})))}),{configs:l,components:a}})(i);E(r,{configs:l,components:t})}return r};class U extends Error{constructor(e,t){super(`${t.message} ("${e}" source)`),this.name="SourceError"}}function z(){return z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a])}return e},z.apply(this,arguments)}const V=async(e,t)=>(await P(z({source:e},t))).configs;export{l as CATEGORIES,t as ConfigCategory,U as SourceError,o as getTransformationOptions,P as parseSource,V as parseSourceConfigs,b as transformResponse,f as transformToConfigValues,i as transformToNested};
//# sourceMappingURL=index.modern.js.map
