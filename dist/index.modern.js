import e,{size as t}from"lodash";const{each:s,setWith:l}=e,n=e=>{const t={};return s(e,(e,s)=>{l(t,s,e,Object)}),t},{has:o}=e,a=e=>{const t={};return function e(t,s,l=[]){Object.entries(s).forEach(([s,n])=>{"object"!=typeof n||Array.isArray(n)||o(n,"default")?t[[...l,s].join(".")]=n:e(t,n,[...l,s])})}(t,e),t};function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},r.apply(this,arguments)}const{each:i,isBoolean:u,isObject:c,last:d,split:f,startsWith:p,trimEnd:b}=e,g=e=>{const t={},s=((e,t="")=>{const s=function e(t,s){if(!t||"object"!=typeof t)return[{[s]:t}];const l=s?Array.isArray(t)?s:`${s}.`:"";return Object.keys(t).flatMap(s=>e(t[s],Array.isArray(t)?`${l}[${s}]`:`${l}${s}`)).reduce((e,t)=>r({},e,t),[])}(e,t),l={};return i(s,(e,t)=>{const s=f(t,"."),n=d(s);p(n,"#")?"#value"===n&&(l[b(t,".#value")]=e):l[t]=e}),l})(e);return i(s,(e,s)=>{let l=e;c(e)&&(l=e["#value"]);const n={default:l};u(l)&&(n.type="switch"),t[s]=n}),t},{assign:y,has:m,isBoolean:h,isObject:$,map:v,mapValues:w,merge:C,size:I}=e,k=(e,t,s=null)=>{let l=null;const n=I(s);if(1!==n)throw new Error(`The "${e}" group must only have one parent key, ${n} given.`);const o=w(s,(e,s)=>{if(!l){let n={type:"switch",default:t};if($(t)){if(!m(t,"default")||!h(t.default))throw new Error('A "default" boolean value must be supplied in the object');C(n,t)}e=y({enabled:n},e),l=`${s}.enabled`}return e});let a=F(e,o);return v(a,(e,t)=>(t!==l&&(e.visibleIf=l),e)),a},{has:j,map:O,mapKeys:A}=e,V=(e,t=null)=>{let s={};const l=`${e}.isVisible`;return s.isVisible={type:"switch",label:"Visible",default:!0,group:e,styleClasses:"col-md-2"},s.required={type:"switch",label:"Required",default:!1,group:e,visibleIf:l,styleClasses:"col-md-2"},s.disabled={type:"switch",label:"Disabled",default:!1,group:e,visibleIf:l,styleClasses:"col-md-2"},s.readonly={type:"switch",label:"Readonly",default:!1,group:e,visibleIf:l,styleClasses:"col-md-2"},s.hasAutoFocus={type:"switch",label:"Autofocus",default:!1,group:e,visibleIf:l,styleClasses:"col-md-2"},s.pattern={type:"input",label:"Pattern",default:"",group:e,visibleIf:l,styleClasses:"col-md-12"},t&&(s=t(s),O(s,(t,s)=>{j(t,"group")||(t.group=e),"isVisible"===s||j(t,"visibleIf")||(t.visibleIf=l),j(t,"styleClasses")||(t.styleClasses="col-md-12")})),F(e,A(s,(t,s)=>`${e}.${s}`))},{map:E}=e,F=(e,t)=>{const s=a(t);return E(s,t=>(t.group=e,t)),s},{merge:q}=e,D=(e,t=null,s=null,l=null)=>{const n={configs:{}};return e&&(n.configs=e),t&&(n.category=t),s&&(n.section=s),l&&q(n,l),n},{mapValues:L,merge:R}=e,x=(e,t)=>L(e,e=>(R(e,{subsection:t}),e)),{assign:K,has:N,map:P,mapValues:T,setWith:W}=e,z=(e,t)=>e.map(e=>{const s="string"==typeof e?e:e.key;if(N(t,s)){const l="object"==typeof e?e:{};return delete l.key,K({model:s},t[s],l)}return console.log(`${s} is not a config!`),null}).filter(e=>{if(null!==e)return e}),B=(e,t,s)=>{const l={name:e,schema:[],model:{}};if(t){const e=((e,t)=>T(e,(e,s)=>({id:s,order:Number(s),label:e.label,fields:z(e.fields,t)})))(t,s);l.schema=e,l.model=(e=>{const t={};return P(e,e=>{P(e.fields,e=>{W(t,e.model,e.default,Object)})}),t})(e)}return l},{assign:S,each:G,get:M,has:U,isObject:H,kebabCase:J,last:Q,mapKeys:X,mapValues:Y,merge:Z,set:_,split:ee,startCase:te,unset:se}=e,le=e=>"boolean"==typeof e.default?"switch":"input",ne=(e,t,s=!1)=>{if(H(t)){if(!s&&!U(t,"default"))throw new Error(`Config "${e}" is missing a "default" value.`)}else t={default:t};return t},oe=(e,t,s={})=>{if(delete(t=ne(e,t)).key,t.docLink){const e=`Documentation on this feature can be found <a href="${t.docLink}">here</a>.`;t.hint=t.hint?e+`<br>${t.hint}`:e,delete t.docLink}return S({default:null,type:le(t),label:te(Q(ee(e,"."))),category:"setting"},t,s)},ae=(e,t={},s=null)=>(e=X(e,(e,t)=>e.key?e.key:t),Y(e,(e,l)=>(s&&s(l,e),oe(l,e,t)))),re=(e,t,s)=>{Z(e,((e,t,s)=>ae(t,s,t=>{if(U(e,t))throw new Error(`Duplicate key: "${t}"`)}))(e,t,s))},ie=(e,t=null)=>S({label:te(Q(ee(e,"."))),order:0,toggleable:!1,description:null,rootKey:null},t),ue=async({getComponents:e,getConfigs:s,getLabel:l,getName:n,source:o})=>{const a=n?n():o,r={name:a,label:l?l():te(a)},i=e?await e():null;if(s){const e=ae(await s()),l=((e,s={})=>{const l={};let n=!1;return G(e,e=>{if(U(e,"component")){if(!U(l,e.component)){let t={};if(U(s,e.component)){const{getOptions:l}=s[e.component];t=l?l():s[e.component]}l[e.component]=ie(e.component,t)}}else n=!0}),n&&t(l)&&(l.unsorted=ie("unsorted",{order:999})),l})(e,i);Z(r,{configs:e,components:l})}else{const{components:e,configs:s}=(e=>{const s={},l=(e=>Y(e,(e,t)=>{const{getOptions:s}=e;return ie(t,s?s():null)}))(e);return G(e,(e,n)=>{const{getConfigs:o,getSettings:a,getTranslations:r,getUI:i}=e,u={component:n},c=((e,s)=>{const l={group:{path:"groups"},tab:{path:"tabs"}},n=(e,t=null)=>{const s={};return G(e,(e,l)=>{if(e=ne(l,e),t){const{config:n,key:o}=t(l,e);s[o]=n}else s[l]=e}),s},o=(o,a,r,i=!0,u="group",c=null)=>(((n,o,a,r="group")=>{let i=l[r].path,u={};G(a,n=>{if(n.group){const o=n.group;G(l,l=>{const n=M(e,[s,l.path,o]);if(n){_(u,[l.path,o],n),se(e,[s,l.path,o]);const a=M(e,[s,l.path],{});0===t(a)&&se(e,[s,l.path])}})}}),_(e,[s,i,n],S({label:o},u))})(o,a,r,u),n(r,(e,t)=>(t.group=t.group?`${o}.${t.group}`:o,c&&c(e,t),{key:i?`${o}.${e}`:e,config:t})));return{addNested:(e,t)=>n(t,(t,s)=>(s.visibleIf&&(s.visibleIf=`${e}.${s.visibleIf}`),{key:`${e}.${t}`,config:s})),addFeature:(e,t,s,l=!1,n=!0)=>{if(U(s,"enabled"))throw new Error(`Feature "${e}" should not contain a property named "enabled".`);return s=S({enabled:ne("enabled",l)},s),o(e,t,s,n,"group",(t,s)=>{"enabled"!==t&&(s.visibleIf=`${e}.enabled`)})},addGroup:o,addTab:(e,t)=>{const s=J(e);return o(s,e,t,!1,"tab")},addField:(e,t=null)=>{let s={};const l=`${e}.isVisible`;if(s.isVisible={default:!0,label:"Visible",styleClasses:"col-md-2"},s.required={default:!1,label:"Required",visibleIf:l,styleClasses:"col-md-2"},s.disabled={default:!1,label:"Disabled",visibleIf:l,styleClasses:"col-md-2"},s.readonly={default:!1,label:"Readonly",visibleIf:l,styleClasses:"col-md-2"},s.hasAutoFocus={default:!1,label:"Autofocus",visibleIf:l,styleClasses:"col-md-2"},s.pattern={default:"",label:"Pattern",visibleIf:l,styleClasses:"col-md-12"},t){const e=(e,t)=>{if(U(s,e))throw new Error(`Field ${e} already exists!`);s[e]=oe(e,t,{visibleIf:l,styleClasses:"col-md-12"})},n=(e,t)=>{Z(s[e],ne(e,t,!0))};t({insert:e,modify:n})}return o(e,te(e),s,!0)}}})(l,n);o?re(s,o(c),u):(a&&re(s,a(c),S(u,{category:"setting"})),r&&re(s,r(c),S(u,{category:"translation"})),i&&re(s,i(c),S(u,{category:"ui"})))}),{configs:s,components:l}})(i);Z(r,{configs:s,components:e})}return r},ce=(e,t=null)=>{t=S({nested:!1},t);const s={};return G(e,(e,t)=>{s[t]=e.default}),t.nested?n(s):s};class de extends Error{constructor(e,t){super(`${t.message} ("${e}" source)`),this.name="SourceError"}}export{de as SourceError,n as convertToNested,a as createConfigs,g as createConfigsFromJson,k as createFeature,V as createField,F as createGroup,D as createSection,x as createSubSection,ce as getMockResponse,B as parseOnboarder,ue as parseSource};
//# sourceMappingURL=index.modern.js.map
