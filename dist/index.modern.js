import e from"lodash";const{each:t,setWith:s}=e,l=e=>{const l={};return t(e,(e,t)=>{s(l,t,e,Object)}),l},{has:n}=e,o=e=>{const t={};return function e(t,s,l=[]){Object.entries(s).forEach(([s,o])=>{"object"!=typeof o||Array.isArray(o)||n(o,"default")?t[[...l,s].join(".")]=o:e(t,o,[...l,s])})}(t,e),t};function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},a.apply(this,arguments)}const{each:r,isBoolean:i,isObject:u,last:c,split:d,startsWith:f,trimEnd:p}=e,b=e=>{const t={},s=((e,t="")=>{const s=function e(t,s){if(!t||"object"!=typeof t)return[{[s]:t}];const l=s?Array.isArray(t)?s:`${s}.`:"";return Object.keys(t).flatMap(s=>e(t[s],Array.isArray(t)?`${l}[${s}]`:`${l}${s}`)).reduce((e,t)=>a({},e,t),[])}(e,t),l={};return r(s,(e,t)=>{const s=d(t,"."),n=c(s);f(n,"#")?"#value"===n&&(l[p(t,".#value")]=e):l[t]=e}),l})(e);return r(s,(e,s)=>{let l=e;u(e)&&(l=e["#value"]);const n={default:l};i(l)&&(n.type="switch"),t[s]=n}),t},{assign:g,has:y,isBoolean:m,isObject:h,map:$,mapValues:v,merge:w,size:C}=e,I=(e,t,s=null)=>{let l=null;const n=C(s);if(1!==n)throw new Error(`The "${e}" group must only have one parent key, ${n} given.`);const o=v(s,(e,s)=>{if(!l){let n={type:"switch",default:t};if(h(t)){if(!y(t,"default")||!m(t.default))throw new Error('A "default" boolean value must be supplied in the object');w(n,t)}e=g({enabled:n},e),l=`${s}.enabled`}return e});let a=E(e,o);return $(a,(e,t)=>(t!==l&&(e.visibleIf=l),e)),a},{has:k,map:j,mapKeys:O}=e,A=(e,t=null)=>{let s={};const l=`${e}.isVisible`;return s.isVisible={type:"switch",label:"Visible",default:!0,group:e,styleClasses:"col-md-2"},s.required={type:"switch",label:"Required",default:!1,group:e,visibleIf:l,styleClasses:"col-md-2"},s.disabled={type:"switch",label:"Disabled",default:!1,group:e,visibleIf:l,styleClasses:"col-md-2"},s.readonly={type:"switch",label:"Readonly",default:!1,group:e,visibleIf:l,styleClasses:"col-md-2"},s.hasAutoFocus={type:"switch",label:"Autofocus",default:!1,group:e,visibleIf:l,styleClasses:"col-md-2"},s.pattern={type:"input",label:"Pattern",default:"",group:e,visibleIf:l,styleClasses:"col-md-12"},t&&(s=t(s),j(s,(t,s)=>{k(t,"group")||(t.group=e),"isVisible"===s||k(t,"visibleIf")||(t.visibleIf=l),k(t,"styleClasses")||(t.styleClasses="col-md-12")})),E(e,O(s,(t,s)=>`${e}.${s}`))},{map:V}=e,E=(e,t)=>{const s=o(t);return V(s,t=>(t.group=e,t)),s},{merge:F}=e,q=(e,t=null,s=null,l=null)=>{const n={configs:{}};return e&&(n.configs=e),t&&(n.category=t),s&&(n.section=s),l&&F(n,l),n},{mapValues:D,merge:L}=e,R=(e,t)=>D(e,e=>(L(e,{subsection:t}),e)),{assign:x,has:K,map:N,mapValues:P,setWith:T}=e,W=(e,t)=>e.map(e=>{const s="string"==typeof e?e:e.key;if(K(t,s)){const l="object"==typeof e?e:{};return delete l.key,x({model:s},t[s],l)}return console.log(`${s} is not a config!`),null}).filter(e=>{if(null!==e)return e}),z=(e,t,s)=>{const l={name:e,schema:[],model:{}};if(t){const e=((e,t)=>P(e,(e,s)=>({id:s,order:Number(s),label:e.label,fields:W(e.fields,t)})))(t,s);l.schema=e,l.model=(e=>{const t={};return N(e,e=>{N(e.fields,e=>{T(t,e.model,e.default,Object)})}),t})(e)}return l},{assign:B,each:S,get:G,has:M,isObject:U,kebabCase:H,last:J,mapKeys:Q,mapValues:X,merge:Y,set:Z,size:_,split:ee,startCase:te,unset:se}=e,le=e=>"boolean"==typeof e.default?"switch":"input",ne=(e,t,s=!1)=>{if(U(t)){if(!s&&!M(t,"default"))throw new Error(`Config "${e}" is missing a "default" value.`)}else t={default:t};return t},oe=(e,t,s={})=>{if(delete(t=ne(e,t)).key,t.docLink){const e=`Documentation on this feature can be found <a href="${t.docLink}">here</a>.`;t.hint=t.hint?e+`<br>${t.hint}`:e,delete t.docLink}return B({default:null,type:le(t),label:te(J(ee(e,"."))),category:"setting"},t,s)},ae=(e,t={},s=null)=>(e=Q(e,(e,t)=>e.key?e.key:t),X(e,(e,l)=>(s&&s(l,e),oe(l,e,t)))),re=(e,t,s)=>{Y(e,((e,t,s)=>ae(t,s,t=>{if(M(e,t))throw new Error(`Duplicate key: "${t}"`)}))(e,t,s))},ie=(e,t=null)=>B({label:te(J(ee(e,"."))),order:0,toggleable:!1,description:null,rootKey:null},t),ue=async({getComponents:e,getConfigs:t,getLabel:s,getName:l,source:n})=>{const o=l?l():n,a={name:o,label:s?s():te(o)},r=e?await e():null;if(t){const e=ae(await t()),s=((e,t={})=>{const s={};let l=!1;return S(e,e=>{if(M(e,"component")){if(!M(s,e.component)){let l={};if(M(t,e.component)){const{getOptions:s}=t[e.component];l=s?s():t[e.component]}s[e.component]=ie(e.component,l)}}else l=!0}),l&&_(s)&&(s.unsorted=ie("unsorted",{order:999})),s})(e,r);Y(a,{configs:e,components:s})}else{const{components:e,configs:t}=(e=>{const t={},s=(e=>X(e,(e,t)=>{const{getOptions:s}=e;return ie(t,s?s():null)}))(e);return S(e,(e,l)=>{const{getConfigs:n,getSettings:o,getTranslations:a,getUI:r}=e,i={component:l},u=((e,t)=>{const s={group:{path:"groups"},tab:{path:"tabs"}},l=(e,t=null)=>{const s={};return S(e,(e,l)=>{if(e=ne(l,e),t){const{config:n,key:o}=t(l,e);s[o]=n}else s[l]=e}),s},n=(n,o,a,r=!0,i="group",u=null)=>(((l,n,o,a="group")=>{let r=s[a].path,i={};S(o,l=>{if(l.group){const n=l.group;S(s,s=>{const l=G(e,[t,s.path,n]);if(l){Z(i,[s.path,n],l),se(e,[t,s.path,n]);const o=G(e,[t,s.path],{});0===_(o)&&se(e,[t,s.path])}})}}),Z(e,[t,r,l],B({label:n},i))})(n,o,a,i),l(a,(e,t)=>(t.group=t.group?`${n}.${t.group}`:n,u&&u(e,t),{key:r?`${n}.${e}`:e,config:t})));return{addNested:(e,t)=>l(t,(t,s)=>(s.visibleIf&&(s.visibleIf=`${e}.${s.visibleIf}`),{key:`${e}.${t}`,config:s})),addFeature:(e,t,s,l=!1,o=!0)=>{if(M(s,"enabled"))throw new Error(`Feature "${e}" should not contain a property named "enabled".`);return s=B({enabled:ne("enabled",l)},s),n(e,t,s,o,"group",(t,s)=>{"enabled"!==t&&(s.visibleIf=`${e}.enabled`)})},addGroup:n,addTab:(e,t)=>{const s=H(e);return n(s,e,t,!1,"tab")},addField:(e,t=null)=>{let s={};const l=`${e}.isVisible`;if(s.isVisible={default:!0,label:"Visible",styleClasses:"col-md-2"},s.required={default:!1,label:"Required",visibleIf:l,styleClasses:"col-md-2"},s.disabled={default:!1,label:"Disabled",visibleIf:l,styleClasses:"col-md-2"},s.readonly={default:!1,label:"Readonly",visibleIf:l,styleClasses:"col-md-2"},s.hasAutoFocus={default:!1,label:"Autofocus",visibleIf:l,styleClasses:"col-md-2"},s.pattern={default:"",label:"Pattern",visibleIf:l,styleClasses:"col-md-12"},t){const e=(e,t)=>{if(M(s,e))throw new Error(`Field ${e} already exists!`);s[e]=oe(e,t,{visibleIf:l,styleClasses:"col-md-12"})},n=(e,t)=>{Y(s[e],ne(e,t,!0))};t({insert:e,modify:n})}return n(e,te(e),s,!0)}}})(s,l);n?re(t,n(u),i):(o&&re(t,o(u),B(i,{category:"setting"})),a&&re(t,a(u),B(i,{category:"translation"})),r&&re(t,r(u),B(i,{category:"ui"})))}),{configs:t,components:s}})(r);Y(a,{configs:t,components:e})}return a},ce=(e,t=null)=>{t=B({nested:!1},t);const s={};return S(e,(e,t)=>{s[t]=e.default}),t.nested?l(s):s};class de extends Error{constructor(e,t){super(`${t.message} ("${e}" source)`),this.name="SourceError"}}export{de as SourceError,l as convertToNested,o as createConfigs,b as createConfigsFromJson,I as createFeature,A as createField,E as createGroup,q as createSection,R as createSubSection,ce as getMockResponse,z as parseOnboarder,ue as parseSource};
//# sourceMappingURL=index.modern.js.map
