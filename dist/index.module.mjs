import e from"lodash";var t,n,r;!function(e){e.Setting="setting",e.Translation="translation",e.UI="ui",e.Feature="feature"}(n||(n={})),function(e){e.Setting="settings",e.Translation="translations",e.UI="ui",e.Feature="features"}(r||(r={}));var o=((t={})[n.Setting]={plural:r.Setting,label:"Setting",labelPlural:"Settings",order:1},t[n.Translation]={plural:r.Translation,label:"Translation",labelPlural:"Translations",order:2},t[n.UI]={plural:r.UI,label:"UI",labelPlural:"UI",order:3},t[n.Feature]={plural:r.Feature,label:"Feature",labelPlural:"Features",order:4},t),i=e.assign,a=e.mapValues,u=function(e){return void 0===e&&(e={}),e=a(e,function(){return!0}),i({nested:!1,categorized:!1},e)},l=e.each,c=e.setWith,s=function(e){var t={};return l(e,function(e,n){c(t,n,e,Object)}),t},f=e.each,d=e.get,p=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n=null);var r=u(t),i=function(e,t){void 0===t&&(t=null);var n={};return f(e,function(e,r){if(t){var o=t(r,e),i=o.key,a=o.value;i&&(r=i),a&&(e=a)}n[r]=e}),n}(e,function(e){if(r.categorized){var t=d(n,e);t&&(e=o[t.category].plural+"."+e)}return{key:e}});return r.nested?s(i):i},v=e.each,b=e.has,g=function(e,t){void 0===t&&(t={});var n=u(t),r=function(e,t){void 0===t&&(t=null);var n={};return v(e,function(e,r){var o=b(e,"value")?e.value:e.default;if(t){var i=t(r,e),a=i.key,u=i.value;a&&(r=a),u&&(o=u)}n[r]=o}),n}(e,function(e,t){return{key:e=n.categorized?o[t.category].plural+"."+e:e}});return n.nested?s(r):r};function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},y.apply(this,arguments)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}function O(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function j(e,t,n){return j=O()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&m(o,n.prototype),o},j.apply(null,arguments)}function w(e){var t="function"==typeof Map?new Map:void 0;return w=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return j(e,arguments,h(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),m(n,e)},w(e)}var P=e.each,k=e.isBoolean,I=e.isObject,L=e.last,F=e.split,C=e.startsWith,E=e.trimEnd,S=function(e){var t={},n=function(e,t){void 0===t&&(t="");var n=function e(t,n){var r;if(!t||"object"!=typeof t)return[(r={},r[n]=t,r)];var o=n?Array.isArray(t)?n:n+".":"";return Object.keys(t).flatMap(function(n){return e(t[n],Array.isArray(t)?o+"["+n+"]":""+o+n)}).reduce(function(e,t){return y({},e,t)},[])}(e,t),r={};return P(n,function(e,t){var n=F(t,"."),o=L(n);C(o,"#")?"#value"===o&&(r[E(t,".#value")]=e):r[t]=e}),r}(e);return P(n,function(e,n){var r=e;I(e)&&(r=e["#value"]);var o={default:r};k(r)&&(o.type="switch"),t[n]=o}),t},T=e.assign,R=e.each,_=e.get,x=e.has,A=e.includes,U=e.isObject,V=e.kebabCase,z=e.last,D=e.mapKeys,q=e.mapValues,B=e.merge,M=e.set,K=e.size,N=e.split,W=e.startCase,G=e.unset,H=function(e){return"object"==typeof e&&"boolean"==typeof e.default?"switch":"input"},J=function(e,t,n){if(void 0===n&&(n=!1),U(t)){if(!n&&!x(t,"default"))throw new Error('Config "'+e+'" is missing a "default" value.')}else t={default:t};return t},Q=function(e,t,n){if(void 0===n&&(n={}),delete(t=J(e,t)).key,t.docLink){var r='Documentation on this feature can be found <a href="'+t.docLink+'">here</a>.';t.hint=t.hint?r+"<br>"+t.hint:r,delete t.docLink}return T({default:null,type:H(t),label:W(z(N(e,"."))),category:"setting"},t,n)},X=function(t,n,r){return void 0===n&&(n={}),t=D(t,function(t,n){return e.get(t,"key",n)}),q(t,function(e,t){return r&&r(t,e),Q(t,e,n)})},Y=function(e,t){return T({label:W(z(N(e,"."))),order:0,toggleable:!1,description:null,rootKey:null},t)},Z=function(e,t){var n={};return R(e,function(e){if(U(e)&&!x(e,"key"))throw new Error("Onboarder config missing key!");var r=U(e)?e.key:e;if(!x(t,r))throw new Error('Onboarder defines key "'+r+'" which does not exist.');n[r]=U(e)?T({},t[r],e):T({},t[r])}),n},$=function(e,t){var n={};return R(e,function(e,r){n[r]={label:e.label?e.label:W(r),configs:Z(e.configs,t)}}),n},ee=function(t){var n=t.getComponents,r=t.getConfigs,o=t.getLabel,i=t.getName,a=t.getOnboarders,u=t.source;try{var l=function(t){function i(o){function i(t){function n(){var e=function(){if(a)return Promise.resolve(a()).then(function(e){var t,n;u.onboarders=(t=u.configs,n={},R(e,function(e,r){var o=e.getLabel,i=e.getTabs;n[r]={label:o?o():W(r),tabs:i?$(i(),t):{}}}),n)})}();return e&&e.then?e.then(function(){return u}):u}var o=function(){if(r)return Promise.resolve(r()).then(function(e){var n=X(e),r=function(e,t){void 0===t&&(t={});var n={},r=!1;return R(e,function(e){if("object"==typeof e&&x(e,"component")){if(!x(n,e.component)){var o={};if(x(t,e.component)){var i=t[e.component].getOptions;o=i?i():t[e.component]}n[e.component]=Y(e.component,o)}}else r=!0}),r&&K(n)&&(n.unsorted=Y("unsorted",{order:999})),n}(n,t);B(u,{configs:n,components:r})});var n,o,i,a=(o={},i=function(e){return q(e,function(e,t){var n=e.getOptions;return Y(t,n?n():null)})}(n=t),R(n,function(t,n){var r=function(t,r){void 0===r&&(r="setting");var a={component:n},u=function(t,n,r){void 0===r&&(r="setting");var o={group:{path:"groups"},tab:{path:"tabs"}},i=[],a=function(e,t){void 0===t&&(t=null);var n={};return R(e,function(e,r){if(e=J(r,e),t){var o=t(r,e);n[o.key]=o.config}else n[r]=e}),n},u=function(e,u,l,c,s,f){return void 0===c&&(c=!0),void 0===s&&(s="group"),A(i,e)?console.warn('"'+e+'" group already exists in "'+r+'"'):i.push(e),function(e,r,i,a){void 0===a&&(a="group");var u=o[a].path,l={};R(i,function(e){if("object"==typeof e&&e.group){var r=e.group;R(o,function(e){var o=_(t,[n,e.path,r]);if(o){M(l,[e.path,r],o),G(t,[n,e.path,r]);var i=_(t,[n,e.path],{});0===K(i)&&G(t,[n,e.path])}})}}),M(t,[n,u,e],T({label:r},l))}(e,u,l,s),a(l,function(t,n){return n.group=n.group?e+"."+n.group:e,f&&f(t,n),{key:c?e+"."+t:t,config:n}})};return{addNested:function(e,t){return a(t,function(t,n){return"object"==typeof n&&(n.visibleIf&&(n.visibleIf=e+"."+n.visibleIf),n.longLabel=W(e)+" ⇢ "+(n.longLabel?n.longLabel:n.label?n.label:W(t))),{key:e+"."+t,config:n}})},addFeature:function(t,n,r,o,i){if(void 0===o&&(o=!1),void 0===i&&(i=!0),x(r,"enabled"))throw new Error('Feature "'+t+'" should not contain a property named "enabled".');return r=T({enabled:J("enabled",o)},r),u(t,n,r,i,"group",function(n,r){"enabled"!==n&&"object"==typeof r&&e.set(r,"visibleIf",t+".enabled")})},addGroup:u,addTab:function(e,t){var n=r+"-"+V(e);return u(n,e,t,!1,"tab")},addField:function(e,t){var n={},r=e+".isVisible",o=W(e),i=o;return n.isVisible={default:!0,label:"Visible",longLabel:o+" ⇢ Visible",styleClasses:"col-md-2"},n.required={default:!1,label:"Required",longLabel:o+" ⇢ Required",visibleIf:r,styleClasses:"col-md-2"},n.disabled={default:!1,label:"Disabled",longLabel:o+" ⇢ Disabled",visibleIf:r,styleClasses:"col-md-2"},n.readonly={default:!1,label:"Readonly",longLabel:o+" ⇢ Readonly",visibleIf:r,styleClasses:"col-md-2"},n.hasAutoFocus={default:!1,label:"Autofocus",longLabel:o+" ⇢ Autofocus",visibleIf:r,styleClasses:"col-md-2"},n.pattern={default:"",label:"Pattern",longLabel:o+" ⇢ Pattern",visibleIf:r,styleClasses:"col-md-12"},t&&t&&t({insert:function(e,t){if(x(n,e))throw new Error("Field "+e+" already exists!");var i=Q(e,t,{visibleIf:r,styleClasses:"col-md-12"});i.longLabel=o+" ⇢ "+i.label,n[e]=i},modify:function(e,t){B(n[e],J(e,t,!0))},modifyLabel:function(e){i=e}}),u(e,i,n,!0)}}}(i,n,r);r&&(a=T(a,{category:r}));var l=t(u);if(K(l)){var c=_(i,[n,"categories"],[]);c.push(r),M(i,[n,"categories"],c),function(e,t,n){B(e,function(e,t,n){return X(t,n,function(t){if(x(e,t))throw new Error('Duplicate key: "'+t+'"')})}(e,t,n))}(o,l,a)}},a=t.getConfigs,u=t.getFeatures,l=t.getSettings,c=t.getTranslations,s=t.getUI;a?r(a):(l&&r(l,"setting"),c&&r(c,"translation"),s&&r(s,"ui"),u&&r(u,"feature"))}),{configs:o,components:i});B(u,{configs:a.configs,components:a.components})}();return o&&o.then?o.then(n):n()}var u={name:t,label:o};return n?Promise.resolve(n()).then(i):i(null)}return o?Promise.resolve(o()).then(i):i(W(t))};return Promise.resolve(i?Promise.resolve(i()).then(l):l(u))}catch(e){return Promise.reject(e)}},te=/*#__PURE__*/function(e){var t,n;function r(t,n){var r;return(r=e.call(this,n.message+' ("'+t+'" source)')||this).name="SourceError",r}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,m(t,n),r}(/*#__PURE__*/w(Error)),ne=function(e,t){try{return Promise.resolve(ee(y({source:e},t))).then(function(e){return e.configs})}catch(e){return Promise.reject(e)}};export{o as CATEGORIES,n as ConfigCategory,r as ConfigCategoryPlurals,te as SourceError,S as createConfigsFromJson,u as getTransformationOptions,ee as parseSource,ne as parseSourceConfigs,p as transformResponse,g as transformToConfigValues,s as transformToNested};
//# sourceMappingURL=index.module.mjs.map
