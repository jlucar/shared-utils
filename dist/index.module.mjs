import e from"lodash";var t=e.assign,n=e.mapValues,o=function(e){return void 0===e&&(e={}),e=n(e,function(){return!0}),t({nested:!1,categorized:!1},e)},r=e.each,i=e.setWith,u=function(e){var t={};return r(e,function(e,n){i(t,n,e,Object)}),t},a=e.each,l=e.get,c=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n=null);var r=o(t),i=function(e,t){void 0===t&&(t=null);var n={};return a(e,function(e,o){if(t){var r=t(o,e),i=r.key,u=r.value;i&&(o=i),u&&(e=u)}n[o]=e}),n}(e,function(e){if(r.categorized){var t=l(n,e);t&&(e=t.category+"."+e)}return{key:e}});return r.nested?u(i):i},f=e.each,s=e.has,p=function(e,t){void 0===t&&(t={});var n=o(t),r=function(e,t){void 0===t&&(t=null);var n={};return f(e,function(e,o){var r=s(e,"value")?e.value:e.default;if(t){var i=t(o,e),u=i.key,a=i.value;u&&(o=u),a&&(r=a)}n[o]=r}),n}(e,function(e,t){return{key:e=n.categorized?t.category+"."+e:e}});return n.nested?u(r):r};function d(){return d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},d.apply(this,arguments)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function y(e,t,n){return y=g()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var r=new(Function.bind.apply(e,o));return n&&b(r,n.prototype),r},y.apply(null,arguments)}function h(e){var t="function"==typeof Map?new Map:void 0;return h=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return y(e,arguments,v(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),b(n,e)},h(e)}var m=e.assign,O=e.each,j=e.get,P=e.has,w=e.isObject,k=e.kebabCase,L=e.last,C=e.mapKeys,I=e.mapValues,R=e.merge,_=e.set,E=e.size,F=e.split,V=e.startCase,x=e.unset,z=function(e){return"object"==typeof e&&"boolean"==typeof e.default?"switch":"input"},D=function(e,t,n){if(void 0===n&&(n=!1),w(t)){if(!n&&!P(t,"default"))throw new Error('Config "'+e+'" is missing a "default" value.')}else t={default:t};return t},S=function(e,t,n){if(void 0===n&&(n={}),delete(t=D(e,t)).key,t.docLink){var o='Documentation on this feature can be found <a href="'+t.docLink+'">here</a>.';t.hint=t.hint?o+"<br>"+t.hint:o,delete t.docLink}return m({default:null,type:z(t),label:V(L(F(e,"."))),category:"setting"},t,n)},q=function(t,n,o){return void 0===n&&(n={}),t=C(t,function(t,n){return e.get(t,"key",n)}),I(t,function(e,t){return o&&o(t,e),S(t,e,n)})},A=function(e,t,n){R(e,function(e,t,n){return q(t,n,function(t){if(P(e,t))throw new Error('Duplicate key: "'+t+'"')})}(e,t,n))},T=function(e,t){return m({label:V(L(F(e,"."))),order:0,toggleable:!1,description:null,rootKey:null},t)},B=function(t){var n=t.getComponents,o=t.getConfigs,r=t.getLabel,i=t.getName,u=t.source;try{var a=function(t){function i(r){function i(t){var n=function(){if(o)return Promise.resolve(o()).then(function(e){var n=q(e),o=function(e,t){void 0===t&&(t={});var n={},o=!1;return O(e,function(e){if("object"==typeof e&&P(e,"component")){if(!P(n,e.component)){var r={};if(P(t,e.component)){var i=t[e.component].getOptions;r=i?i():t[e.component]}n[e.component]=T(e.component,r)}}else o=!0}),o&&E(n)&&(n.unsorted=T("unsorted",{order:999})),n}(n,t);R(u,{config:n,components:o})});var n,r,i,a=(r={},i=function(e){return I(e,function(e,t){var n=e.getOptions;return T(t,n?n():null)})}(n=t),O(n,function(t,n){var o=t.getConfigs,u=t.getSettings,a=t.getTranslations,l=t.getUI,c={component:n},f=function(t,n){var o={group:{path:"groups"},tab:{path:"tabs"}},r=function(e,t){void 0===t&&(t=null);var n={};return O(e,function(e,o){if(e=D(o,e),t){var r=t(o,e);n[r.key]=r.config}else n[o]=e}),n},i=function(e,i,u,a,l,c){return void 0===a&&(a=!0),void 0===l&&(l="group"),function(e,r,i,u){void 0===u&&(u="group");var a=o[u].path,l={};O(i,function(e){if("object"==typeof e&&e.group){var r=e.group;O(o,function(e){var o=j(t,[n,e.path,r]);if(o){_(l,[e.path,r],o),x(t,[n,e.path,r]);var i=j(t,[n,e.path],{});0===E(i)&&x(t,[n,e.path])}})}}),_(t,[n,a,e],m({label:r},l))}(e,i,u,l),r(u,function(t,n){return n.group=n.group?e+"."+n.group:e,c&&c(t,n),{key:a?e+"."+t:t,config:n}})};return{addNested:function(e,t){return r(t,function(t,n){return"object"==typeof n&&(n.visibleIf&&(n.visibleIf=e+"."+n.visibleIf),n.longLabel=V(e)+" ⇢ "+(n.longLabel?n.longLabel:n.label?n.label:V(t))),{key:e+"."+t,config:n}})},addFeature:function(t,n,o,r,u){if(void 0===r&&(r=!1),void 0===u&&(u=!0),P(o,"enabled"))throw new Error('Feature "'+t+'" should not contain a property named "enabled".');return o=m({enabled:D("enabled",r)},o),i(t,n,o,u,"group",function(n,o){"enabled"!==n&&"object"==typeof o&&e.set(o,"visibleIf",t+".enabled")})},addGroup:i,addTab:function(e,t){var n=k(e);return i(n,e,t,!1,"tab")},addField:function(e,t){var n={},o=e+".isVisible",r=V(e);return n.isVisible={default:!0,label:"Visible",longLabel:r+" ⇢ Visible",styleClasses:"col-md-2"},n.required={default:!1,label:"Required",longLabel:r+" ⇢ Required",visibleIf:o,styleClasses:"col-md-2"},n.disabled={default:!1,label:"Disabled",longLabel:r+" ⇢ Disabled",visibleIf:o,styleClasses:"col-md-2"},n.readonly={default:!1,label:"Readonly",longLabel:r+" ⇢ Readonly",visibleIf:o,styleClasses:"col-md-2"},n.hasAutoFocus={default:!1,label:"Autofocus",longLabel:r+" ⇢ Autofocus",visibleIf:o,styleClasses:"col-md-2"},n.pattern={default:"",label:"Pattern",longLabel:r+" ⇢ Pattern",visibleIf:o,styleClasses:"col-md-12"},t&&t&&t({insert:function(e,t){if(P(n,e))throw new Error("Field "+e+" already exists!");var i=S(e,t,{visibleIf:o,styleClasses:"col-md-12"});i.longLabel=r+" ⇢ "+i.label,n[e]=i},modify:function(e,t){R(n[e],D(e,t,!0))}}),i(e,V(e),n,!0)}}}(i,n);o?A(r,o(f),c):(u&&A(r,u(f),m(c,{category:"setting"})),a&&A(r,a(f),m(c,{category:"translation"})),l&&A(r,l(f),m(c,{category:"ui"})))}),{configs:r,components:i});R(u,{configs:a.configs,components:a.components})}();return n&&n.then?n.then(function(){return u}):u}var u={name:t,label:r};return n?Promise.resolve(n()).then(i):i(null)}return r?Promise.resolve(r()).then(i):i(V(t))};return Promise.resolve(i?Promise.resolve(i()).then(a):a(u))}catch(e){return Promise.reject(e)}},K=/*#__PURE__*/function(e){var t,n;function o(t,n){var o;return(o=e.call(this,n.message+' ("'+t+'" source)')||this).name="SourceError",o}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,b(t,n),o}(/*#__PURE__*/h(Error)),M=function(e,t){try{return Promise.resolve(B(d({source:e},t))).then(function(e){return e.configs})}catch(e){return Promise.reject(e)}};export{K as SourceError,o as getTransformationOptions,B as parseSource,M as parseSourceConfigs,c as transformResponse,p as transformToConfigValues,u as transformToNested};
//# sourceMappingURL=index.module.mjs.map
