import e from"lodash";var t=e.each,n=e.setWith,r=function(e){var r={};return t(e,function(e,t){n(r,t,e,Object)}),r},o=e.has,i=function(e){var t={};return function e(t,n,r){void 0===r&&(r=[]),Object.entries(n).forEach(function(n){var i=n[0],u=n[1];"object"!=typeof u||Array.isArray(u)||o(u,"default")?t[[].concat(r,[i]).join(".")]=u:e(t,u,[].concat(r,[i]))})}(t,e),t};function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function c(e,t,n){return c=s()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&l(o,n.prototype),o},c.apply(null,arguments)}function f(e){var t="function"==typeof Map?new Map:void 0;return f=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return c(e,arguments,a(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),l(n,e)},f(e)}var p=e.each,d=e.isBoolean,v=e.isObject,b=e.last,y=e.split,g=e.startsWith,m=e.trimEnd,h=function(e){var t={},n=function(e,t){void 0===t&&(t="");var n=function e(t,n){var r;if(!t||"object"!=typeof t)return[(r={},r[n]=t,r)];var o=n?Array.isArray(t)?n:n+".":"";return Object.keys(t).flatMap(function(n){return e(t[n],Array.isArray(t)?o+"["+n+"]":""+o+n)}).reduce(function(e,t){return u({},e,t)},[])}(e,t),r={};return p(n,function(e,t){var n=y(t,"."),o=b(n);g(o,"#")?"#value"===o&&(r[m(t,".#value")]=e):r[t]=e}),r}(e);return p(n,function(e,n){var r=e;v(e)&&(r=e["#value"]);var o={default:r};d(r)&&(o.type="switch"),t[n]=o}),t},j=e.map,w=function(e,t){var n=i(t);return j(n,function(t){return"object"==typeof t&&(t.group=e),t}),n},O=e.assign,C=e.has,I=e.isBoolean,k=e.isObject,P=e.map,A=e.mapValues,E=e.merge,V=e.size,R=function(e,t,n){void 0===n&&(n=null);var r=null,o="object"==typeof n&&V(n)||-1;if(1!==o)throw new Error('The "'+e+'" group must only have one parent key, '+o+" given.");var i="object"==typeof n&&A(n,function(e,n){if(!r){var o={type:"switch",default:t};if(k(t)){if(!C(t,"default")||!I(t.default))throw new Error('A "default" boolean value must be supplied in the object');E(o,t)}e=O({enabled:o},e),r=n+".enabled"}return e}),u=w(e,i);return P(u,function(e,t){return"object"==typeof e&&t!==r&&(e.visibleIf=r),e}),u},F=e.has,_=e.map,x=e.mapKeys,q=function(t,n){void 0===n&&(n=null);var r={},o=t+".isVisible";r.isVisible={type:"switch",label:"Visible",default:!0,group:t,styleClasses:"col-md-2"},r.required={type:"switch",label:"Required",default:!1,group:t,visibleIf:o,styleClasses:"col-md-2"},r.disabled={type:"switch",label:"Disabled",default:!1,group:t,visibleIf:o,styleClasses:"col-md-2"},r.readonly={type:"switch",label:"Readonly",default:!1,group:t,visibleIf:o,styleClasses:"col-md-2"},r.hasAutoFocus={type:"switch",label:"Autofocus",default:!1,group:t,visibleIf:o,styleClasses:"col-md-2"},r.pattern={type:"input",label:"Pattern",default:"",group:t,visibleIf:o,styleClasses:"col-md-12"},n&&(r=n(r),_(r,function(n,r){"object"!=typeof n||F(n,"group")||(n.group=t),"object"!=typeof n||"isVisible"===r||F(n,"visibleIf")||e.set(n,"visibleIf",o),"object"!=typeof n||F(n,"styleClasses")||(n.styleClasses="col-md-12")}));var i=x(r,function(e,n){return t+"."+n});return w(t,i)},B=e.merge,D=function(e,t,n,r){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null);var o={configs:{}};return e&&(o.configs=e),t&&(o.category=t),n&&(o.section=n),r&&B(o,r),o},L=e.mapValues,S=e.merge,T=function(e,t){return L(e,function(e){return S(e,{subsection:t}),e})},K=e.assign,M=e.has,N=e.map,W=e.mapValues,z=e.setWith,G=function(t,n){return t.map(function(t){var r="string"==typeof t?t:e.get(t,"key");if(M(n,r)){var o="object"==typeof t?t:{};return delete o.key,K({model:r},n[r],o)}return console.log(r+" is not a config!"),null}).filter(function(e){if(null!==e)return e})},U=function(e,t,n){var r={name:e,schema:[],model:{}};if(t){var o=function(e,t){return W(e,function(e,n){return{id:n,order:Number(n),label:e.label,fields:G(e.fields,t)}})}(t,n);r.schema=o,r.model=function(e){var t={};return N(e,function(e){N(e.fields,function(e){z(t,e.model,e.default,Object)})}),t}(o)}return r},H=e.assign,J=e.each,Q=e.get,X=e.has,Y=e.isObject,Z=e.kebabCase,$=e.last,ee=e.mapKeys,te=e.mapValues,ne=e.merge,re=e.set,oe=e.size,ie=e.split,ue=e.startCase,ae=e.unset,le=function(e){return"object"==typeof e&&"boolean"==typeof e.default?"switch":"input"},se=function(e,t,n){if(void 0===n&&(n=!1),Y(t)){if(!n&&!X(t,"default"))throw new Error('Config "'+e+'" is missing a "default" value.')}else t={default:t};return t},ce=function(e,t,n){if(void 0===n&&(n={}),delete(t=se(e,t)).key,t.docLink){var r='Documentation on this feature can be found <a href="'+t.docLink+'">here</a>.';t.hint=t.hint?r+"<br>"+t.hint:r,delete t.docLink}return H({default:null,type:le(t),label:ue($(ie(e,"."))),category:"setting"},t,n)},fe=function(t,n,r){return void 0===n&&(n={}),t=ee(t,function(t,n){return e.get(t,"key",n)}),te(t,function(e,t){return r&&r(t,e),ce(t,e,n)})},pe=function(e,t,n){ne(e,function(e,t,n){return fe(t,n,function(t){if(X(e,t))throw new Error('Duplicate key: "'+t+'"')})}(e,t,n))},de=function(e,t){return H({label:ue($(ie(e,"."))),order:0,toggleable:!1,description:null,rootKey:null},t)},ve=function(t){var n=t.getComponents,r=t.getConfigs,o=t.getLabel,i=t.getName,u=t.source;try{var a=function(t){function i(o){function i(t){var n=function(){if(r)return Promise.resolve(r()).then(function(e){var n=fe(e),r=function(e,t){void 0===t&&(t={});var n={},r=!1;return J(e,function(e){if("object"==typeof e&&X(e,"component")){if(!X(n,e.component)){var o={};if(X(t,e.component)){var i=t[e.component].getOptions;o=i?i():t[e.component]}n[e.component]=de(e.component,o)}}else r=!0}),r&&oe(n)&&(n.unsorted=de("unsorted",{order:999})),n}(n,t);ne(u,{config:n,components:r})});var n,o,i,a=(o={},i=function(e){return te(e,function(e,t){var n=e.getOptions;return de(t,n?n():null)})}(n=t),J(n,function(t,n){var r=t.getConfigs,u=t.getSettings,a=t.getTranslations,l=t.getUI,s={component:n},c=function(t,n){var r={group:{path:"groups"},tab:{path:"tabs"}},o=function(e,t){void 0===t&&(t=null);var n={};return J(e,function(e,r){if(e=se(r,e),t){var o=t(r,e);n[o.key]=o.config}else n[r]=e}),n},i=function(e,i,u,a,l,s){return void 0===a&&(a=!0),void 0===l&&(l="group"),function(e,o,i,u){void 0===u&&(u="group");var a=r[u].path,l={};J(i,function(e){if("object"==typeof e&&e.group){var o=e.group;J(r,function(e){var r=Q(t,[n,e.path,o]);if(r){re(l,[e.path,o],r),ae(t,[n,e.path,o]);var i=Q(t,[n,e.path],{});0===oe(i)&&ae(t,[n,e.path])}})}}),re(t,[n,a,e],H({label:o},l))}(e,i,u,l),o(u,function(t,n){return n.group=n.group?e+"."+n.group:e,s&&s(t,n),{key:a?e+"."+t:t,config:n}})};return{addNested:function(e,t){return o(t,function(t,n){return"object"==typeof n&&n.visibleIf&&(n.visibleIf=e+"."+n.visibleIf),{key:e+"."+t,config:n}})},addFeature:function(t,n,r,o,u){if(void 0===o&&(o=!1),void 0===u&&(u=!0),X(r,"enabled"))throw new Error('Feature "'+t+'" should not contain a property named "enabled".');return r=H({enabled:se("enabled",o)},r),i(t,n,r,u,"group",function(n,r){"enabled"!==n&&"object"==typeof r&&e.set(r,"visibleIf",t+".enabled")})},addGroup:i,addTab:function(e,t){var n=Z(e);return i(n,e,t,!1,"tab")},addField:function(e,t){var n={},r=e+".isVisible";return n.isVisible={default:!0,label:"Visible",styleClasses:"col-md-2"},n.required={default:!1,label:"Required",visibleIf:r,styleClasses:"col-md-2"},n.disabled={default:!1,label:"Disabled",visibleIf:r,styleClasses:"col-md-2"},n.readonly={default:!1,label:"Readonly",visibleIf:r,styleClasses:"col-md-2"},n.hasAutoFocus={default:!1,label:"Autofocus",visibleIf:r,styleClasses:"col-md-2"},n.pattern={default:"",label:"Pattern",visibleIf:r,styleClasses:"col-md-12"},t&&t&&t({insert:function(e,t){if(X(n,e))throw new Error("Field "+e+" already exists!");n[e]=ce(e,t,{visibleIf:r,styleClasses:"col-md-12"})},modify:function(e,t){ne(n[e],se(e,t,!0))}}),i(e,ue(e),n,!0)}}}(i,n);r?pe(o,r(c),s):(u&&pe(o,u(c),H(s,{category:"setting"})),a&&pe(o,a(c),H(s,{category:"translation"})),l&&pe(o,l(c),H(s,{category:"ui"})))}),{configs:o,components:i});ne(u,{configs:a.configs,components:a.components})}();return n&&n.then?n.then(function(){return u}):u}var u={name:t,label:o};return n?Promise.resolve(n()).then(i):i(null)}return o?Promise.resolve(o()).then(i):i(ue(t))};return Promise.resolve(i?Promise.resolve(i()).then(a):a(u))}catch(e){return Promise.reject(e)}},be=function(e,t){void 0===t&&(t=null),t=H({nested:!1},t);var n={};return J(e,function(e,t){n[t]=e.default}),t.nested?r(n):n},ye=/*#__PURE__*/function(e){var t,n;function r(t,n){var r;return(r=e.call(this,n.message+' ("'+t+'" source)')||this).name="SourceError",r}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n),r}(/*#__PURE__*/f(Error));export{ye as SourceError,r as convertToNested,i as createConfigs,h as createConfigsFromJson,R as createFeature,q as createField,w as createGroup,D as createSection,T as createSubSection,be as getMockResponse,U as parseOnboarder,ve as parseSource};
//# sourceMappingURL=index.module.mjs.map
