import e from"lodash";var t=e.assign,n=e.mapValues,r=function(e){return void 0===e&&(e={}),e=n(e,function(){return!0}),t({nested:!1,categorized:!1},e)},o=e.each,i=e.get,u=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n=null);var u=r(t),a=function(e,t){void 0===t&&(t=null);var n={};return o(e,function(e,r){if(t){var o=t(r,e),i=o.key,u=o.value;i&&(r=i),u&&(e=u)}n[r]=e}),n}(e,function(e){if(u.categorized){var t=i(n,e);t&&(e=t.category+"."+e)}return{key:e}});return u.nested?d(a):a},a=e.each,l=e.has,c=function(e,t){void 0===t&&(t={});var n=r(t),o=function(e,t){void 0===t&&(t=null);var n={};return a(e,function(e,r){var o=l(e,"value")?e.value:e.default;if(t){var i=t(r,e),u=i.key,a=i.value;u&&(r=u),a&&(o=a)}n[r]=o}),n}(e,function(e,t){return{key:e=n.categorized?t.category+"."+e:e}});return n.nested?d(o):o},f=e.each,s=e.setWith,d=function(e){var t={};return f(e,function(e,n){s(t,n,e,Object)}),t};function p(){return p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p.apply(this,arguments)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function y(e,t,n){return y=g()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&b(o,n.prototype),o},y.apply(null,arguments)}function h(e){var t="function"==typeof Map?new Map:void 0;return h=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return y(e,arguments,v(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),b(n,e)},h(e)}var m=e.assign,O=e.each,k=e.get,w=e.has,L=e.isObject,P=e.kebabCase,C=e.last,j=e.mapKeys,I=e.mapValues,R=e.merge,_=e.set,E=e.size,F=e.split,V=e.startCase,x=e.unset,z=function(e){return"boolean"==typeof e.default?"switch":"input"},D=function(e,t,n){if(void 0===n&&(n=!1),L(t)){if(!n&&!w(t,"default"))throw new Error('Config "'+e+'" is missing a "default" value.')}else t={default:t};return t},S=function(e,t,n){if(void 0===n&&(n={}),delete(t=D(e,t)).key,t.docLink){var r='Documentation on this feature can be found <a href="'+t.docLink+'">here</a>.';t.hint=t.hint?r+"<br>"+t.hint:r,delete t.docLink}return m({default:null,type:z(t),label:V(C(F(e,"."))),category:"setting"},t,n)},q=function(e,t,n){return void 0===t&&(t={}),void 0===n&&(n=null),e=j(e,function(e,t){return e.key?e.key:t}),I(e,function(e,r){return n&&n(r,e),S(r,e,t)})},A=function(e,t,n){R(e,function(e,t,n){return q(t,n,function(t){if(w(e,t))throw new Error('Duplicate key: "'+t+'"')})}(e,t,n))},T=function(e,t){return void 0===t&&(t=null),m({label:V(C(F(e,"."))),order:0,toggleable:!1,description:null,rootKey:null},t)},B=function(e){var t=e.getComponents,n=e.getConfigs,r=e.getLabel,o=e.getName,i=e.source;try{var u=function(e){var t=function(){if(n)return Promise.resolve(n()).then(function(t){var n=q(t),r=function(e,t){void 0===t&&(t={});var n={},r=!1;return O(e,function(e){if(w(e,"component")){if(!w(n,e.component)){var o={};if(w(t,e.component)){var i=t[e.component].getOptions;o=i?i():t[e.component]}n[e.component]=T(e.component,o)}}else r=!0}),r&&E(n)&&(n.unsorted=T("unsorted",{order:999})),n}(n,e);R(l,{configs:n,components:r})});var t,r,o,i=(r={},o=function(e){return I(e,function(e,t){var n=e.getOptions;return T(t,n?n():null)})}(t=e),O(t,function(e,t){var n=e.getConfigs,i=e.getSettings,u=e.getTranslations,a=e.getUI,l={component:t},c=function(e,t){var n={group:{path:"groups"},tab:{path:"tabs"}},r=function(e,t){void 0===t&&(t=null);var n={};return O(e,function(e,r){if(e=D(r,e),t){var o=t(r,e);n[o.key]=o.config}else n[r]=e}),n},o=function(o,i,u,a,l,c){return void 0===a&&(a=!0),void 0===l&&(l="group"),void 0===c&&(c=null),function(r,o,i,u){void 0===u&&(u="group");var a=n[u].path,l={};O(i,function(r){if(r.group){var o=r.group;O(n,function(n){var r=k(e,[t,n.path,o]);if(r){_(l,[n.path,o],r),x(e,[t,n.path,o]);var i=k(e,[t,n.path],{});0===E(i)&&x(e,[t,n.path])}})}}),_(e,[t,a,r],m({label:o},l))}(o,i,u,l),r(u,function(e,t){return t.group=t.group?o+"."+t.group:o,c&&c(e,t),{key:a?o+"."+e:e,config:t}})};return{addNested:function(e,t){return r(t,function(t,n){return n.visibleIf&&(n.visibleIf=e+"."+n.visibleIf),n.longLabel=V(e)+" ⇢ "+(n.longLabel?n.longLabel:n.label?n.label:V(t)),{key:e+"."+t,config:n}})},addFeature:function(e,t,n,r,i){if(void 0===r&&(r=!1),void 0===i&&(i=!0),w(n,"enabled"))throw new Error('Feature "'+e+'" should not contain a property named "enabled".');return n=m({enabled:D("enabled",r)},n),o(e,t,n,i,"group",function(t,n){"enabled"!==t&&(n.visibleIf=e+".enabled")})},addGroup:o,addTab:function(e,t){var n=P(e);return o(n,e,t,!1,"tab")},addField:function(e,t){void 0===t&&(t=null);var n={},r=e+".isVisible",i=V(e);return n.isVisible={default:!0,label:"Visible",longLabel:i+" ⇢ Visible",styleClasses:"col-md-2"},n.required={default:!1,label:"Required",longLabel:i+" ⇢ Required",visibleIf:r,styleClasses:"col-md-2"},n.disabled={default:!1,label:"Disabled",longLabel:i+" ⇢ Disabled",visibleIf:r,styleClasses:"col-md-2"},n.readonly={default:!1,label:"Readonly",longLabel:i+" ⇢ Readonly",visibleIf:r,styleClasses:"col-md-2"},n.hasAutoFocus={default:!1,label:"Autofocus",longLabel:i+" ⇢ Autofocus",visibleIf:r,styleClasses:"col-md-2"},n.pattern={default:"",label:"Pattern",longLabel:i+" ⇢ Pattern",visibleIf:r,styleClasses:"col-md-12"},t&&t({insert:function(e,t){if(w(n,e))throw new Error("Field "+e+" already exists!");var o=S(e,t,{visibleIf:r,styleClasses:"col-md-12"});o.longLabel=i+" ⇢ "+o.label,n[e]=o},modify:function(e,t){R(n[e],D(e,t,!0))}}),o(e,V(e),n,!0)}}}(o,t);n?A(r,n(c),l):(i&&A(r,i(c),m(l,{category:"setting"})),u&&A(r,u(c),m(l,{category:"translation"})),a&&A(r,a(c),m(l,{category:"ui"})))}),{configs:r,components:o});R(l,{configs:i.configs,components:i.components})}();return t&&t.then?t.then(function(){return l}):l},a=o?o():i,l={name:a,label:r?r():V(a)};return Promise.resolve(t?Promise.resolve(t()).then(u):u(null))}catch(e){return Promise.reject(e)}},K=/*#__PURE__*/function(e){var t,n;function r(t,n){var r;return(r=e.call(this,n.message+' ("'+t+'" source)')||this).name="SourceError",r}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,b(t,n),r}(/*#__PURE__*/h(Error)),M=function(e,t){try{return Promise.resolve(B(p({source:e},t))).then(function(e){return e.configs})}catch(e){return Promise.reject(e)}};export{K as SourceError,r as getTransformationOptions,B as parseSource,M as parseSourceConfigs,u as transformResponse,c as transformToConfigValues,d as transformToNested};
//# sourceMappingURL=index.module.mjs.map
