!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("lodash")):"function"==typeof define&&define.amd?define(["exports","lodash"],t):t((e||self).utils={},e.lodash)}(this,function(e,t){function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r,o,a,u=/*#__PURE__*/n(t);e.ConfigCategory=void 0,(o=e.ConfigCategory||(e.ConfigCategory={})).Setting="setting",o.Translation="translation",o.UI="ui",o.Feature="feature",e.ConfigCategoryPlurals=void 0,(a=e.ConfigCategoryPlurals||(e.ConfigCategoryPlurals={})).Setting="settings",a.Translation="translations",a.UI="ui",a.Feature="features";var i=((r={})[e.ConfigCategory.Setting]={plural:e.ConfigCategoryPlurals.Setting,label:"Setting",labelPlural:"Settings",order:1},r[e.ConfigCategory.Translation]={plural:e.ConfigCategoryPlurals.Translation,label:"Translation",labelPlural:"Translations",order:2},r[e.ConfigCategory.UI]={plural:e.ConfigCategoryPlurals.UI,label:"UI",labelPlural:"UI",order:3},r[e.ConfigCategory.Feature]={plural:e.ConfigCategoryPlurals.Feature,label:"Feature",labelPlural:"Features",order:4},r),l=u.default.assign,f=u.default.mapValues,s=function(e){return void 0===e&&(e={}),e=f(e,function(){return!0}),l({nested:!1,categorized:!1},e)},c=u.default.each,d=u.default.setWith,g=function(e){var t={};return c(e,function(e,n){d(t,n,e,Object)}),t},p=u.default.each,b=u.default.get,v=u.default.each,y=u.default.has;function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h.apply(this,arguments)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function C(e,t){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},C(e,t)}function O(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function P(e,t,n){return P=O()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&C(o,n.prototype),o},P.apply(null,arguments)}function j(e){var t="function"==typeof Map?new Map:void 0;return j=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return P(e,arguments,m(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),C(n,e)},j(e)}var w=u.default.each,k=u.default.isBoolean,I=u.default.isObject,L=u.default.last,T=u.default.split,F=u.default.startsWith,S=u.default.trimEnd,E=u.default.assign,R=u.default.each,x=u.default.get,A=u.default.has,_=u.default.isObject,U=u.default.kebabCase,V=u.default.last,q=u.default.mapKeys,z=u.default.mapValues,D=u.default.merge,B=u.default.set,M=u.default.size,N=u.default.split,G=u.default.startCase,K=u.default.unset,W=function(e){return"object"==typeof e&&"boolean"==typeof e.default?"switch":"input"},J=function(e,t,n){if(void 0===n&&(n=!1),_(t)){if(!n&&!A(t,"default"))throw new Error('Config "'+e+'" is missing a "default" value.')}else t={default:t};return t},H=function(e,t,n){if(void 0===n&&(n={}),delete(t=J(e,t)).key,t.docLink){var r='Documentation on this feature can be found <a href="'+t.docLink+'">here</a>.';t.hint=t.hint?r+"<br>"+t.hint:r,delete t.docLink}return E({default:null,type:W(t),label:G(V(N(e,"."))),category:"setting"},t,n)},Q=function(e,t,n){return void 0===t&&(t={}),e=q(e,function(e,t){return u.default.get(e,"key",t)}),z(e,function(e,r){return n&&n(r,e),H(r,e,t)})},X=function(e,t,n){D(e,function(e,t,n){return Q(t,n,function(t){if(A(e,t))throw new Error('Duplicate key: "'+t+'"')})}(e,t,n))},Y=function(e,t){return E({label:G(V(N(e,"."))),order:0,toggleable:!1,description:null,rootKey:null},t)},Z=function(e,t){var n={};return R(e,function(e){if(_(e)&&!A(e,"key"))throw new Error("Onboarder config missing key!");var r=_(e)?e.key:e;if(!A(t,r))throw new Error('Onboarder defines key "'+r+'" which does not exist.');n[r]=_(e)?E({},t[r],e):E({},t[r])}),n},$=function(e,t){var n={};return R(e,function(e,r){n[r]={label:e.label?e.label:G(r),configs:Z(e.configs,t)}}),n},ee=function(e){var t=e.getComponents,n=e.getConfigs,r=e.getLabel,o=e.getName,a=e.getOnboarders,i=e.source;try{var l=function(e){function o(r){function o(e){function t(){var e=function(){if(a)return Promise.resolve(a()).then(function(e){var t,n;i.onboarders=(t=i.configs,n={},R(e,function(e,r){var o=e.getLabel,a=e.getTabs;n[r]={label:o?o():G(r),tabs:a?$(a(),t):{}}}),n)})}();return e&&e.then?e.then(function(){return i}):i}var r=function(){if(n)return Promise.resolve(n()).then(function(t){var n=Q(t),r=function(e,t){void 0===t&&(t={});var n={},r=!1;return R(e,function(e){if("object"==typeof e&&A(e,"component")){if(!A(n,e.component)){var o={};if(A(t,e.component)){var a=t[e.component].getOptions;o=a?a():t[e.component]}n[e.component]=Y(e.component,o)}}else r=!0}),r&&M(n)&&(n.unsorted=Y("unsorted",{order:999})),n}(n,e);D(i,{configs:n,components:r})});var t,r,o,a=(r={},o=function(e){return z(e,function(e,t){var n=e.getOptions;return Y(t,n?n():null)})}(t=e),R(t,function(e,t){var n=e.getConfigs,a=e.getFeatures,i=e.getSettings,l=e.getTranslations,f=e.getUI,s={component:t},c=function(e,t){var n={group:{path:"groups"},tab:{path:"tabs"}},r=function(e,t){void 0===t&&(t=null);var n={};return R(e,function(e,r){if(e=J(r,e),t){var o=t(r,e);n[o.key]=o.config}else n[r]=e}),n},o=function(o,a,u,i,l,f){return void 0===i&&(i=!0),void 0===l&&(l="group"),function(r,o,a,u){void 0===u&&(u="group");var i=n[u].path,l={};R(a,function(r){if("object"==typeof r&&r.group){var o=r.group;R(n,function(n){var r=x(e,[t,n.path,o]);if(r){B(l,[n.path,o],r),K(e,[t,n.path,o]);var a=x(e,[t,n.path],{});0===M(a)&&K(e,[t,n.path])}})}}),B(e,[t,i,r],E({label:o},l))}(o,a,u,l),r(u,function(e,t){return t.group=t.group?o+"."+t.group:o,f&&f(e,t),{key:i?o+"."+e:e,config:t}})};return{addNested:function(e,t){return r(t,function(t,n){return"object"==typeof n&&(n.visibleIf&&(n.visibleIf=e+"."+n.visibleIf),n.longLabel=G(e)+" ⇢ "+(n.longLabel?n.longLabel:n.label?n.label:G(t))),{key:e+"."+t,config:n}})},addFeature:function(e,t,n,r,a){if(void 0===r&&(r=!1),void 0===a&&(a=!0),A(n,"enabled"))throw new Error('Feature "'+e+'" should not contain a property named "enabled".');return n=E({enabled:J("enabled",r)},n),o(e,t,n,a,"group",function(t,n){"enabled"!==t&&"object"==typeof n&&u.default.set(n,"visibleIf",e+".enabled")})},addGroup:o,addTab:function(e,t){var n=U(e);return o(n,e,t,!1,"tab")},addField:function(e,t){var n={},r=e+".isVisible",a=G(e),u=a;return n.isVisible={default:!0,label:"Visible",longLabel:a+" ⇢ Visible",styleClasses:"col-md-2"},n.required={default:!1,label:"Required",longLabel:a+" ⇢ Required",visibleIf:r,styleClasses:"col-md-2"},n.disabled={default:!1,label:"Disabled",longLabel:a+" ⇢ Disabled",visibleIf:r,styleClasses:"col-md-2"},n.readonly={default:!1,label:"Readonly",longLabel:a+" ⇢ Readonly",visibleIf:r,styleClasses:"col-md-2"},n.hasAutoFocus={default:!1,label:"Autofocus",longLabel:a+" ⇢ Autofocus",visibleIf:r,styleClasses:"col-md-2"},n.pattern={default:"",label:"Pattern",longLabel:a+" ⇢ Pattern",visibleIf:r,styleClasses:"col-md-12"},t&&t&&t({insert:function(e,t){if(A(n,e))throw new Error("Field "+e+" already exists!");var o=H(e,t,{visibleIf:r,styleClasses:"col-md-12"});o.longLabel=a+" ⇢ "+o.label,n[e]=o},modify:function(e,t){D(n[e],J(e,t,!0))},modifyLabel:function(e){u=e}}),o(e,u,n,!0)}}}(o,t);n?X(r,n(c),s):(i&&X(r,i(c),E(s,{category:"setting"})),l&&X(r,l(c),E(s,{category:"translation"})),f&&X(r,f(c),E(s,{category:"ui"})),a&&X(r,a(c),E(s,{category:"feature"})))}),{configs:r,components:o});D(i,{configs:a.configs,components:a.components})}();return r&&r.then?r.then(t):t()}var i={name:e,label:r};return t?Promise.resolve(t()).then(o):o(null)}return r?Promise.resolve(r()).then(o):o(G(e))};return Promise.resolve(o?Promise.resolve(o()).then(l):l(i))}catch(e){return Promise.reject(e)}},te=/*#__PURE__*/function(e){var t,n;function r(t,n){var r;return(r=e.call(this,n.message+' ("'+t+'" source)')||this).name="SourceError",r}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,C(t,n),r}(/*#__PURE__*/j(Error));e.CATEGORIES=i,e.SourceError=te,e.createConfigsFromJson=function(e){var t={},n=function(e,t){void 0===t&&(t="");var n=function e(t,n){var r;if(!t||"object"!=typeof t)return[(r={},r[n]=t,r)];var o=n?Array.isArray(t)?n:n+".":"";return Object.keys(t).flatMap(function(n){return e(t[n],Array.isArray(t)?o+"["+n+"]":""+o+n)}).reduce(function(e,t){return h({},e,t)},[])}(e,t),r={};return w(n,function(e,t){var n=T(t,"."),o=L(n);F(o,"#")?"#value"===o&&(r[S(t,".#value")]=e):r[t]=e}),r}(e);return w(n,function(e,n){var r=e;I(e)&&(r=e["#value"]);var o={default:r};k(r)&&(o.type="switch"),t[n]=o}),t},e.getTransformationOptions=s,e.parseSource=ee,e.parseSourceConfigs=function(e,t){try{return Promise.resolve(ee(h({source:e},t))).then(function(e){return e.configs})}catch(e){return Promise.reject(e)}},e.transformResponse=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n=null);var r=s(t),o=function(e,t){void 0===t&&(t=null);var n={};return p(e,function(e,r){if(t){var o=t(r,e),a=o.key,u=o.value;a&&(r=a),u&&(e=u)}n[r]=e}),n}(e,function(e){if(r.categorized){var t=b(n,e);t&&(e=i[t.category].plural+"."+e)}return{key:e}});return r.nested?g(o):o},e.transformToConfigValues=function(e,t){void 0===t&&(t={});var n=s(t),r=function(e,t){void 0===t&&(t=null);var n={};return v(e,function(e,r){var o=y(e,"value")?e.value:e.default;if(t){var a=t(r,e),u=a.key,i=a.value;u&&(r=u),i&&(o=i)}n[r]=o}),n}(e,function(e,t){return{key:e=n.categorized?i[t.category].plural+"."+e:e}});return n.nested?g(r):r},e.transformToNested=g});
//# sourceMappingURL=index.umd.js.map
